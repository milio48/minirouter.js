// minirouter.js v1
class minirouterjs{constructor(t="",e=!1){this.routes=[],this.baseUrl=t,this.hashMode=e,this.notFoundCallback=null,this.beforeHook=null,this.afterHook=null,new MutationObserver((()=>this.updateLinks())).observe(document.body,{childList:!0,subtree:!0}),this.init()}init(){document.addEventListener("click",(t=>{const e=t.target.closest("a");if(e&&e.href){if(e.hasAttribute("data-router")&&"false"===e.getAttribute("data-router"))return;t.preventDefault(),this.handleLinkClick(e)}})),window.addEventListener("popstate",(()=>{this.handleNavigation(window.location.pathname+window.location.search)})),window.addEventListener("DOMContentLoaded",(()=>{let t=window.location.pathname;this.hashMode&&(t=window.location.hash?window.location.hash.replace("#",""):"/"),this.go(t)}))}updateLinks(){let t=this.hashMode?"/#":"";document.querySelectorAll("a").forEach((e=>{e.getAttribute("href").startsWith("http")||e.getAttribute("href").startsWith(this.baseUrl)?!this.hashMode||e.getAttribute("href").startsWith("/#/")||e.getAttribute("href").startsWith("./")||e.getAttribute("href").startsWith("../")||(e.href=t+this.baseUrl+e.getAttribute("href")):e.getAttribute("href").startsWith("./")||e.getAttribute("href").startsWith("../")?e.href=t+this.baseUrl+"/"+e.getAttribute("href"):e.href=t+this.baseUrl+e.getAttribute("href")}))}go(t,e){t.startsWith("http")||t.startsWith(this.baseUrl)||(t=t.startsWith("./")||t.startsWith("../")?this.baseUrl+"/"+t:this.baseUrl+t),this.hashMode&&(t=`#${t}`),this.navigate(t,e)}handleLinkClick(t){const e=t.href,s=this.getPathFromHref(e);s.startsWith(this.baseUrl)?this.navigate(s,t):window.location.href=e}handleNavigation(t){this.beforeHook&&!1===this.beforeHook(t)||(this.hashMode&&window.location.hash&&(t=window.location.hash.replace("#","")),this.route(t.replace(this.baseUrl,"")))}getPathFromHref(t){const e=new URL(t,window.location.origin);let s=this.hashMode?e.hash.replace("#",""):e.pathname;return e.search&&(s+=e.search),s}navigate(t,e){if(this.beforeHook&&!1===this.beforeHook(t))return;this.hashMode&&(t=t.replace("/#/","")),this.hashMode?(t=t.startsWith("#")?t.slice(1):t,history.pushState({},"",`#${t}`)):history.pushState({},"",t);let s=t.replace(this.baseUrl,"")||"/";this.route(s,e)}route(t,e){for(const{pattern:s,callback:r}of this.routes){const a=this.matchRoute(s,t);if(a)return r(a,e),void(this.afterHook&&this.afterHook(t,e))}this.notFoundCallback?this.notFoundCallback(t,e):console.log(`No route matched for: ${t}`)}matchRoute(t,e){const[s,r]=t.split("?"),[a,h]=e.split("?"),i=new RegExp("^"+s.replace(/:\w+/g,"([^/]+)")+"$"),o=a.match(i);if(o){const t={param:e,query:{}};if((s.match(/:\w+/g)||[]).forEach(((e,s)=>{t[e.substring(1)]=o[s+1]})),h){const e=new URLSearchParams(h);for(const[s,r]of e)t.query[s]=r}return t}return null}set(t,e){this.routes.push({pattern:t,callback:e})}setNotFound(t){this.notFoundCallback=t}setBefore(t){this.beforeHook=t}setAfter(t){this.afterHook=t}escapeHTML(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}unescapeHTML(t){return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#039;/g,"'")}}